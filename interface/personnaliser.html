<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>OffiBoard - Personnaliser</title>
		<link href="dropdown-menu.css" media="screen" rel="stylesheet" type="text/css" />
		
		<!-- Bootstraps -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		
		<!-- AngularJS -->
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
		<script src="https://cdn.gitcdn.link/cdn/angular/bower-material/v1.1.5/angular-material.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

		<!-- ng-table -->
		<link rel="stylesheet" href="http://cdn.jsdelivr.net/angular.ngtable/0.3.2/ng-table.css">
        <script src="http://cdn.jsdelivr.net/angular.ngtable/0.3.2/ng-table.js"></script>
		
		<!-- Dates en français -->
		<script src="angular-locale_fr-fr.js"></script>
		
		<link rel="stylesheet" href="styleDSQ.css" />
		<script data-require="angular.js@1.0.x" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js" data-semver="1.0.8"></script>
		<script> 
			var app = angular.module('TestUploadFile', ["ngTable"]);
		</script>

		<script src="upload.js"></script>
		<script src="app.js"></script>
	</head>

	<body ng-app="TestUploadFile" ng-controller="JsonUploadController">

		<ul id="navigation" class="nav-main">
			<li class="offiTitle">OffiBoard</li>
			<li><a href="accueil.html">Accueil</a></li>
			<li><a href="#">Ventes</a></li>
			<li><a href="#">Achats</a></li>
			<li><a href="#">Clients</a></li>
			<li><a href="#">Collectivités</a></li>
			<li><a href="#">Opérateurs</a></li>
			<li><a href="#">Produits</a></li>
			<li><a href="personnaliser.html">Personnaliser</a></li>
		</ul>
		
		<div class="container">
			<p style="float: right;">Le {{ clock | date:"EEEE dd MMMM yyyy"}} à {{ clock | date:"HH:mm:ss"}}</p>
		</div>

		<br>
		<span><center><h3><font face="verdana">Liste des Widgets</font></h3></center></span>

		<div id="flexDisplay2">
			
			<div ng-repeat="widget in listWidgets">
				<b>Nom : </b>{{widget.nomWidget}}
				<br>
				<b>JSON : </b>{{widget.jsonName}}
				<br>
				<b>Axe X : </b>{{widget.selectX}}
				<br>
				<b>Axe Y : </b>{{widget.selectY}}
				<br>
				<b>Section : </b>{{widget.sectionWidget}}
			</div>
		</div>

		<div id="droit">
			<ul>
				<a href="#"><button type="button"  data-toggle="modal" data-target="#Ajout">Ajouter</button></a>
				<a href="#"><button type="button" data-toggle="modal" data-target="#Modifier">Modifier</button></a>
				<a href="#"><button type="button" data-toggle="modal" data-target="#Supprimer">Supprimer</button></a>
			</ul>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="Ajout" role="dialog" style="width:100%;">
		
			<div class="modal-dialog" style="width:100%; height:575px;">

				<!-- Modal content-->
				<div class="modal-content" style="width:100%; height:575px;">
				
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Ajouter un Widget</h4>
					</div>
					
					<div class="modal-body" style="width:100%;">
					
						<form>
							<!--
							<div id="ajoutModal" style="width:100%;">
		
							</div>
							<script>document.getElementById("ajoutModal").innerHTML='<object style="width:100%; height:500px;" type="text/html" data="index.html" ></object>';</script> -->
						
							<div id="flexDisplay">
									
								<div id="conteneur" style="margin: 0;">
										
									<div class="col-md-8">
											
										<form>
											<input type="file" ng-model="selectedJson" read-text="onFileSelect($files)">
										</form>
										<br>
										<i ng-hide="jsonSrc">Aucun json sélectionné</i>
												
										<br>
												
										<span><b ng-show="jsonSrc">Choisir le premier axe :</b></span> 
										<select ng-show="jsonSrc" ng-model="selectedX" ng-options="keys.indexOf(key) as key for key in keys">
										</select>
										<br>
										<span ng-show="types[selectedX]"> Type du premier axe : {{types[selectedX]}} </span>
												
										<br><br>
												
										<span><b ng-show="jsonSrc">Choisir le second axe :</b></span> 
										<select ng-show="jsonSrc" ng-model="selectedY" ng-options="keys.indexOf(key2) as key2 for key2 in keys">
										</select>
										<button ng-show="jsonSrc" id="ajoutAxe">+</button>
										<br>
										<span ng-show="types[selectedY]">Type du second axe : {{types[selectedY]}}</span>
										<div id="axesY"></div>

									</div>
												
								</div>

								<div id="conteneur"  style="margin: 0 auto;">
									<div ng-show="types[selectedX]=='date' && selectedY ">
										Fonction somme par mois : 
										<input type="text" placeholder="Choisissez l'année" ng-model="selectedYear">
										<br>
										<div ng-show="selectedYear">
											<span>{{keys[selectedY].toString()}} par mois en {{selectedYear}} :</span>
											<br><br>
											<table>
												<tr>
													<th>Mois</th><th>{{keys[selectedY]}}</th>
												</tr>
												<tr ng-repeat="CA in sumValuesByMonth(keys[selectedX].toString(),keys[selectedY].toString(),selectedYear)">
													<td>{{ getMonthsNames()[$index] }}</td>
													<td >{{ sumValuesByMonth(keys[selectedX].toString(),keys[selectedY].toString(),selectedYear)[$index] }}</td>
												</tr>
											</table>
										</div>
									</div>
								</div>
										
								<div id="conteneur" ng-show="keys[selectedX] && keys[selectedY]">
										
									<div>
										Lignes affichées (max : {{getValues(keys[selectedX]).length}}) :
										<input ng-model="display_limit1" type="text" size="5">
												
										<br><br>
											
										<table class="table table-bordered table-condensed table-striped">
											<thead>
												<tr>
													<th width="200">{{keys[selectedX]}}</th><th width="200">{{keys[selectedY]}}</th>
												</tr>
											</thead>
											<div class="scrollit">
												<tbody>
													<tr>
														<td colspan="2">
															<div class="scrollit">
																<table>
																	<tr ng-repeat="value in getValues(keys[selectedX]) | limitTo:display_limit1">
																		<td width="200">
																			{{ getValues(keys[selectedX])[$index] }}
																		</td>
																		<td width="200">
																			{{ getValues(keys[selectedY])[$index] }}
																		</td>   
																	</tr>
																</table>
															</div>
														</td>
													</tr>
												</tbody>
											</div>
										</table>
									</div>
								</div>
								
								<div style="margin: 0 auto;">
									<b>Nom du Widget :</b>
									<input ng-model="widgetName" type="text" placeholder="">
									<br><br>
									
									<b>Section du Widget :</b>
									<select ng-model="sectionWidget" ng-init="sectionWidget = listeSection[0]" ng-options="option for option in listeSection">
									</select>
									
									<br><br>
									<center><button class="btn btn-success" ng-click="widgetAdd(selectedJson, keys[selectedX],keys[selectedY], sectionWidget, widgetName)" data-dismiss="modal">Ajouter</button></center>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="Modifier" role="dialog">
		
			<div class="modal-dialog">

				<!-- Modal content-->
				<div class="modal-content">
				
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Modifier un Widget</h4>
					</div>
					
					<div class="modal-body">

						<form role="form">

							<p>Choisir le Widget à modifier：</p>
								
							<select>
								<option value ="graphe1">Widget 1 </option>
								<option value ="graphe2">Widget 2</option>
								<option value="graphe3">Widget 3</option>
								<option value="graphe4">Widget 4</option>
							</select>
							
							<p>Axe</p>

							<p><button ng-click="todoAdd()">Ajouter</button></p>

							<br>

							<div ng-repeat="x in todoList">
								<input type="checkbox" ng-model="x.done"> <span ng-bind="x.todoText"></span>
							</div>

							<p><button ng-click="remove()">Supprimer</button></p>
							<p>Modifier le type de graphe</p>
							<select>
								<option value ="Camembert">Camembert </option>
								<option value ="Histogramme">Histogramme</option>
								<option value="Diagramme">Diagramme en bâtons</option>
								<option value="Nuage">Nuage de points</option>
							</select>

							<p>Graphes proposés</p>
							<select>
								<option value ="Camembert">Camembert </option>
								<option value ="Histogramme">Histogramme</option>
								<option value="Diagramme">Diagramme en bâtons</option>
								<option value="Nuage">Nuage de points</option>
							</select>

							<p>Choisir la section du graphe</p>
							<select>
								<option value ="Ventes">Ventes </option>
								<option value ="Achats">Achats</option>
								<option value="Clients">Clients</option>
								<option value="Collectivites">Collectivités</option>
								<option value="Operateurs">Opérateurs</option>
								<option value="Produits">Produits</option>
							</select>
							
							<button type="submit" class="btn btn-success btn-block">Modifier</button>
						</form>
					</div>
					
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Quitter</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="Supprimer" role="dialog">
		
			<div class="modal-dialog">

				<!-- Modal content-->
				<div class="modal-content">
				
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Supprimer un Widget</h4>
					</div>
					
					<div class="modal-body">

						<form role="form" action="#">

							<p>Choisir les Widgets à supprimer :</p>
							<table border="1">
								<tr>
									<td>Liste des Widgets</td>
									<td>Supprimer</td>
								</tr>
								<tr ng-repeat="widget in listWidgets">
									<td>
										<b>Nom : </b>{{widget.nomWidget}}
										<br>
										<b>JSON : </b>{{widget.jsonName}}
										<br>
										<b>Axe X : </b>{{widget.selectX}}
										<br>
										<b>Axe Y : </b>{{widget.selectY}}
										<br>
										<b>Section : </b>{{widget.sectionWidget}}
									</td>
									<td><input type="checkbox" ng-click="checkBoxClick($index)"/></td>
								</tr>
							</table>

						</form>
					</div>
					
					<div class="modal-footer">
						<button class="btn btn-success" ng-click="widgetDelete()" data-dismiss="modal">Supprimer</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">Quitter</button>
					</div>
				</div>
			</div>
		</div>

	</body>
		
</html>